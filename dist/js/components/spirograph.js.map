{"version":3,"sources":["../../../src/js/components/spirograph.jsx"],"names":["Spirograph","props","updateCanvasSize","bind","canvas","findDOMNode","refs","spiroCanvas","cs","getComputedStyle","height","parseInt","getPropertyValue","width","nextProps","isDrawing","draw","theta","ctx","getContext","centerX","centerY","translate","scale","console","log","interval","setInterval","nextLine","outerRadiusInPixels","innerRadiusInPixels","pointFromCenterInPixels","val1","val2","x","Math","cos","y","sin","moveTo","lineTo","clearInterval","lineThickness","lineColor","lineTransparency","speed","maxLoops","beginPath","lineWidth","strokeStyle","r","g","b","i","PI","batchedLineTo","stroke","onComplete","Component"],"mappings":"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","file":"spirograph.js","sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { observer } from 'mobx-react';\r\nimport _ from 'lodash';\r\nimport utils from '../core/utils';\r\n\r\n\r\nclass Spirograph extends React.Component {\r\n\r\n\tconstructor (props) {\r\n\t\tsuper(props);\r\n\t\tthis.updateCanvasSize = this.updateCanvasSize.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount () {\r\n\t\tthis.updateCanvasSize();\r\n\t}\r\n\r\n\t// when the component is mounted or the screen is resized, we need to recompute the width of the canvas area HERE. \r\n\t// That updates the information in the panel store.\r\n\tupdateCanvasSize() {\r\n\t\tconst canvas = ReactDOM.findDOMNode(this.refs.spiroCanvas);\r\n\r\n\t\tlet cs = getComputedStyle(canvas);\r\n\t\tcanvas.height = parseInt(cs.getPropertyValue('height'), 10);\r\n\t\tcanvas.width = parseInt(cs.getPropertyValue('width'), 10);\r\n\r\n\t\tthis.props.updateCanvasSize({ \r\n\t\t\twidth: canvas.width,\r\n\t\t\theight: canvas.height\r\n\t\t});\r\n\t}\r\n\r\n\tshouldComponentUpdate(nextProps) {\r\n\t\tif (nextProps.isDrawing && !this.props.isDrawing) {\r\n\t\t\tthis.draw();\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tdraw () {\r\n\t\t// meh... there's no WAY I'm storing references to this component's DOM content in the sodding store...\r\n\t\tthis.theta = 0;\r\n\t\tthis.canvas = ReactDOM.findDOMNode(this.refs.spiroCanvas);\r\n\t\tthis.ctx = this.canvas.getContext('2d');\r\n\r\n\t\tthis.ctx.centerX = this.canvas.width / 2;\r\n\t\tthis.ctx.centerY = this.canvas.height / 2;\r\n\r\n\t\t// move the center to the middle of the canvas and invert the axis so it appears to\r\n\t\t// draw the spirograph in the right order\r\n\t\tthis.ctx.translate(this.ctx.centerX, this.ctx.centerY);\r\n\t\tthis.ctx.scale(1, -1);\r\n\r\nconsole.log(this.props);\r\n\r\n\t\tthis.interval = setInterval(() => {\r\n\t\t\tthis.nextLine();\r\n\t\t}, 30);\r\n\t}\r\n\r\n\tbatchedLineTo () {\r\n\t\tconst { outerRadiusInPixels, innerRadiusInPixels, pointFromCenterInPixels } = this.props;\r\n\r\n\t\tlet val1 = this.theta * (1 - outerRadiusInPixels / innerRadiusInPixels);\r\n\t\tlet val2 = innerRadiusInPixels - outerRadiusInPixels;\r\n\t\tlet x = Math.cos(this.theta) * val2 + pointFromCenterInPixels * Math.cos(val1);\r\n\t\tlet y = Math.sin(this.theta) * val2 + pointFromCenterInPixels * Math.sin(val1);\r\n\t\tthis.ctx.moveTo(x, y);\r\n\r\n\t\tthis.theta += 0.01;\r\n\t\tval1 = this.theta * (1 - outerRadiusInPixels / innerRadiusInPixels);\r\n\t\tval2 = innerRadiusInPixels - outerRadiusInPixels;\r\n\t\tx = Math.cos(this.theta) * val2 + pointFromCenterInPixels * Math.cos(val1);\r\n\t\ty = Math.sin(this.theta) * val2 + pointFromCenterInPixels * Math.sin(val1);\r\n\t\tthis.ctx.lineTo(x, y);\r\n\t}\r\n\r\n\tonComplete () {\r\n\t\tclearInterval(this.interval);\r\n\t}\r\n\r\n\tnextLine () {\r\n\t\tconst { lineThickness, lineColor, lineTransparency, speed, maxLoops } = this.props;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\t\tthis.ctx.lineWidth = lineThickness;\r\n\t\tthis.ctx.strokeStyle = `rgba(${lineColor.r}, ${lineColor.g}, ${lineColor.b}, ${lineTransparency})`;\r\n\r\n\t\tfor (var i=0; i<speed; i++) {\r\n\t\t\tif (this.theta / Math.PI / 2 > maxLoops) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis.batchedLineTo();\r\n\t\t}\r\n\t\tthis.ctx.stroke();\r\n\r\n\t\tif (this.theta / (Math.PI * 2) > maxLoops) {\r\n\t\t\tconsole.log('complete.')\r\n\t\t\tthis.onComplete();\r\n\t\t}\r\n\t}\r\n\r\n\trender () {\r\n//\t\tconst { canvasHeight, canvasWidth } = this.props;  \r\n// width={width} height={height}\r\n\t\treturn (\r\n\t\t\t<canvas className=\"spiroCanvas\" ref=\"spiroCanvas\"></canvas>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nexport default Spirograph;\r\n"]}